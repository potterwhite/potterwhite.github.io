<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-cn" class="no-js">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>QtQuick工程里的main函数解析 | 嵌入式系统爱好者</title>
<meta name="description" content="当然！这是对 main 函数的详细解读，涵盖了各个部分的功能和目的。
代码逐行解释 int main(int argc, char *argv[]) { QGuiApplication::setAttribute(Qt::AA_UseSoftwareOpenGL); QGuiApplication::setAttribute(Qt::AA_UseSoftwareOpenGL);：设置 Qt 应用程序的属性，强制使用软件渲染 OpenGL。这在没有硬件加速的环境中（例如某些虚拟机或嵌入式系统）非常有用，确保 OpenGL 渲染功能的兼容性。 set_qt_environment(); set_qt_environment()：这似乎是一个自定义函数，用于设置 Qt 环境的其他参数或配置。具体内容取决于你的实际实现。 QGuiApplication GUI_app(argc, argv); QGuiApplication：创建 Qt 的 GUI 应用程序对象，处理与用户界面相关的任务。argc 和 argv 用于传递命令行参数。 // 文件路径 QString iconPath = &#34;://images/icons/app_icon.svg&#34;; iconPath：指定应用程序图标的路径。路径使用 Qt 的资源系统（:// 表示 Qt 资源路径）。 // 检查文件是否存在 if (QFile::exists(iconPath)) { // 文件存在，设置图标 glb_GUI_app.setWindowIcon(QIcon(iconPath)); // qDebug() &lt;&lt; &#34;Icon found and set.&#34;; } else { // 文件不存在，处理错误 qDebug() &lt;&lt; &#34;main(): Icon file not found:&#34; &lt;&lt; iconPath &lt;&lt;&#34;currentDir=&#34;&lt;&lt; QDir::currentPath(); } QFile::exists(iconPath)：检查指定路径的图标文件是否存在。 glb_GUI_app.setWindowIcon(QIcon(iconPath))：如果图标文件存在，则设置应用程序的窗口图标。 qDebug()：用于调试输出，显示图标文件的存在状态和当前工作目录。如果图标文件不存在，会输出相关错误信息。 // ********************** qml ********************************************** QQmlApplicationEngine engine; // const QUrl url(u&#34;qrc:/qt/qml/Main/main.qml&#34;_qs); const QUrl url(u&#34;qrc:/qt/qml/content/Entry.qml&#34;_qs); QQmlApplicationEngine：创建 QML 引擎对象，用于加载和管理 QML 文件。 url：指定要加载的 QML 文件的路径。这里加载的是 Entry.qml 文件。 ASCtl_Opts *class_opts = new Class_Opts(); Class_Opts：创建一个 C&#43;&#43; 自定义类的实例，这个对象将暴露给 QML 界面，以便在 QML 中访问和使用。 QObject::connect(button, )：注释掉了的代码行，可能是用于连接某个按钮的信号和槽。 QObject::connect( &amp;engine, &amp;QQmlApplicationEngine::objectCreated, &amp;GUI_app, [url](QObject *obj, const QUrl &amp;objUrl) { if (!obj &amp;&amp; url == objUrl) QCoreApplication::exit(-1); }, Qt::QueuedConnection); QObject::connect：连接信号和槽。这里连接的是 QQmlApplicationEngine 的 objectCreated 信号到一个 lambda 函数。 objectCreated：表示 QML 对象已经创建。 lambda 函数：检查创建的对象是否为空，并且 URL 是否与预期的 URL 匹配。如果对象为空且 URL 匹配，则应用程序退出，返回错误码 -1。 Qt::QueuedConnection：信号和槽的连接类型，表示槽函数将在接收线程的事件循环中执行。 engine.addImportPath(QCoreApplication::applicationDirPath() &#43; &#34;/qml&#34;); engine.addImportPath(&#34;:/&#34;); addImportPath：添加 QML 模块的导入路径。第一个路径是应用程序的工作目录下的 qml 子目录，第二个路径是 Qt 的资源系统路径。 engine.rootContext()-&gt;setContextProperty(&#34;class_Opts&#34;, class_opts); engine.load(url); setContextProperty：将 C&#43;&#43; 对象 (class_opts) 设置为 QML 上下文属性，使 QML 可以访问这个对象。 engine.load(url)：加载指定的 QML 文件并显示其界面。 if (engine.rootObjects().isEmpty()) { return -1; } rootObjects()：获取 QML 引擎中加载的根对象。如果根对象为空，说明 QML 文件加载失败，程序返回 -1 退出。 return glb_GUI_app.exec(); } GUI_app.exec()：启动应用程序的事件循环。这个方法会阻塞，直到应用程序退出。它处理所有的用户输入、定时器事件等。 总结 设置属性：设置 Qt 应用程序的属性来使用软件渲染 OpenGL。 设置环境：调用自定义函数来配置 Qt 环境。 创建应用程序对象：QGuiApplication 处理 GUI 相关任务。 设置图标：检查并设置应用程序窗口图标。 创建 QML 引擎：用于加载和管理 QML 文件。 创建和设置 C&#43;&#43; 对象：将 C&#43;&#43; 对象暴露给 QML。 连接信号和槽：确保 QML 文件正确加载。 设置导入路径：为 QML 引擎添加模块导入路径。 加载 QML 文件：实际加载并显示 QML 界面。 启动事件循环：进入事件循环，处理应用程序事件。 这个 main 函数展示了如何在 Qt 中设置应用程序图标、加载 QML 界面，并将 C&#43;&#43; 对象暴露给 QML，同时确保应用程序在启动时能够正确处理潜在的错误。">
<meta property="og:url" content="http://localhost:1313/zh-cn/blog/013_qt_development/qml/qml_main/">
  <meta property="og:site_name" content="嵌入式系统爱好者">
  <meta property="og:title" content="QtQuick工程里的main函数解析">
  <meta property="og:description" content="当然！这是对 main 函数的详细解读，涵盖了各个部分的功能和目的。
代码逐行解释 int main(int argc, char *argv[]) { QGuiApplication::setAttribute(Qt::AA_UseSoftwareOpenGL); QGuiApplication::setAttribute(Qt::AA_UseSoftwareOpenGL);：设置 Qt 应用程序的属性，强制使用软件渲染 OpenGL。这在没有硬件加速的环境中（例如某些虚拟机或嵌入式系统）非常有用，确保 OpenGL 渲染功能的兼容性。 set_qt_environment(); set_qt_environment()：这似乎是一个自定义函数，用于设置 Qt 环境的其他参数或配置。具体内容取决于你的实际实现。 QGuiApplication GUI_app(argc, argv); QGuiApplication：创建 Qt 的 GUI 应用程序对象，处理与用户界面相关的任务。argc 和 argv 用于传递命令行参数。 // 文件路径 QString iconPath = &#34;://images/icons/app_icon.svg&#34;; iconPath：指定应用程序图标的路径。路径使用 Qt 的资源系统（:// 表示 Qt 资源路径）。 // 检查文件是否存在 if (QFile::exists(iconPath)) { // 文件存在，设置图标 glb_GUI_app.setWindowIcon(QIcon(iconPath)); // qDebug() &lt;&lt; &#34;Icon found and set.&#34;; } else { // 文件不存在，处理错误 qDebug() &lt;&lt; &#34;main(): Icon file not found:&#34; &lt;&lt; iconPath &lt;&lt;&#34;currentDir=&#34;&lt;&lt; QDir::currentPath(); } QFile::exists(iconPath)：检查指定路径的图标文件是否存在。 glb_GUI_app.setWindowIcon(QIcon(iconPath))：如果图标文件存在，则设置应用程序的窗口图标。 qDebug()：用于调试输出，显示图标文件的存在状态和当前工作目录。如果图标文件不存在，会输出相关错误信息。 // ********************** qml ********************************************** QQmlApplicationEngine engine; // const QUrl url(u&#34;qrc:/qt/qml/Main/main.qml&#34;_qs); const QUrl url(u&#34;qrc:/qt/qml/content/Entry.qml&#34;_qs); QQmlApplicationEngine：创建 QML 引擎对象，用于加载和管理 QML 文件。 url：指定要加载的 QML 文件的路径。这里加载的是 Entry.qml 文件。 ASCtl_Opts *class_opts = new Class_Opts(); Class_Opts：创建一个 C&#43;&#43; 自定义类的实例，这个对象将暴露给 QML 界面，以便在 QML 中访问和使用。 QObject::connect(button, )：注释掉了的代码行，可能是用于连接某个按钮的信号和槽。 QObject::connect( &amp;engine, &amp;QQmlApplicationEngine::objectCreated, &amp;GUI_app, [url](QObject *obj, const QUrl &amp;objUrl) { if (!obj &amp;&amp; url == objUrl) QCoreApplication::exit(-1); }, Qt::QueuedConnection); QObject::connect：连接信号和槽。这里连接的是 QQmlApplicationEngine 的 objectCreated 信号到一个 lambda 函数。 objectCreated：表示 QML 对象已经创建。 lambda 函数：检查创建的对象是否为空，并且 URL 是否与预期的 URL 匹配。如果对象为空且 URL 匹配，则应用程序退出，返回错误码 -1。 Qt::QueuedConnection：信号和槽的连接类型，表示槽函数将在接收线程的事件循环中执行。 engine.addImportPath(QCoreApplication::applicationDirPath() &#43; &#34;/qml&#34;); engine.addImportPath(&#34;:/&#34;); addImportPath：添加 QML 模块的导入路径。第一个路径是应用程序的工作目录下的 qml 子目录，第二个路径是 Qt 的资源系统路径。 engine.rootContext()-&gt;setContextProperty(&#34;class_Opts&#34;, class_opts); engine.load(url); setContextProperty：将 C&#43;&#43; 对象 (class_opts) 设置为 QML 上下文属性，使 QML 可以访问这个对象。 engine.load(url)：加载指定的 QML 文件并显示其界面。 if (engine.rootObjects().isEmpty()) { return -1; } rootObjects()：获取 QML 引擎中加载的根对象。如果根对象为空，说明 QML 文件加载失败，程序返回 -1 退出。 return glb_GUI_app.exec(); } GUI_app.exec()：启动应用程序的事件循环。这个方法会阻塞，直到应用程序退出。它处理所有的用户输入、定时器事件等。 总结 设置属性：设置 Qt 应用程序的属性来使用软件渲染 OpenGL。 设置环境：调用自定义函数来配置 Qt 环境。 创建应用程序对象：QGuiApplication 处理 GUI 相关任务。 设置图标：检查并设置应用程序窗口图标。 创建 QML 引擎：用于加载和管理 QML 文件。 创建和设置 C&#43;&#43; 对象：将 C&#43;&#43; 对象暴露给 QML。 连接信号和槽：确保 QML 文件正确加载。 设置导入路径：为 QML 引擎添加模块导入路径。 加载 QML 文件：实际加载并显示 QML 界面。 启动事件循环：进入事件循环，处理应用程序事件。 这个 main 函数展示了如何在 Qt 中设置应用程序图标、加载 QML 界面，并将 C&#43;&#43; 对象暴露给 QML，同时确保应用程序在启动时能够正确处理潜在的错误。">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="zh-cn">
    <meta property="article:published_time" content="2024-08-20T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-08-20T00:00:00+00:00">

  <meta itemprop="name" content="QtQuick工程里的main函数解析">
  <meta itemprop="description" content="当然！这是对 main 函数的详细解读，涵盖了各个部分的功能和目的。
代码逐行解释 int main(int argc, char *argv[]) { QGuiApplication::setAttribute(Qt::AA_UseSoftwareOpenGL); QGuiApplication::setAttribute(Qt::AA_UseSoftwareOpenGL);：设置 Qt 应用程序的属性，强制使用软件渲染 OpenGL。这在没有硬件加速的环境中（例如某些虚拟机或嵌入式系统）非常有用，确保 OpenGL 渲染功能的兼容性。 set_qt_environment(); set_qt_environment()：这似乎是一个自定义函数，用于设置 Qt 环境的其他参数或配置。具体内容取决于你的实际实现。 QGuiApplication GUI_app(argc, argv); QGuiApplication：创建 Qt 的 GUI 应用程序对象，处理与用户界面相关的任务。argc 和 argv 用于传递命令行参数。 // 文件路径 QString iconPath = &#34;://images/icons/app_icon.svg&#34;; iconPath：指定应用程序图标的路径。路径使用 Qt 的资源系统（:// 表示 Qt 资源路径）。 // 检查文件是否存在 if (QFile::exists(iconPath)) { // 文件存在，设置图标 glb_GUI_app.setWindowIcon(QIcon(iconPath)); // qDebug() &lt;&lt; &#34;Icon found and set.&#34;; } else { // 文件不存在，处理错误 qDebug() &lt;&lt; &#34;main(): Icon file not found:&#34; &lt;&lt; iconPath &lt;&lt;&#34;currentDir=&#34;&lt;&lt; QDir::currentPath(); } QFile::exists(iconPath)：检查指定路径的图标文件是否存在。 glb_GUI_app.setWindowIcon(QIcon(iconPath))：如果图标文件存在，则设置应用程序的窗口图标。 qDebug()：用于调试输出，显示图标文件的存在状态和当前工作目录。如果图标文件不存在，会输出相关错误信息。 // ********************** qml ********************************************** QQmlApplicationEngine engine; // const QUrl url(u&#34;qrc:/qt/qml/Main/main.qml&#34;_qs); const QUrl url(u&#34;qrc:/qt/qml/content/Entry.qml&#34;_qs); QQmlApplicationEngine：创建 QML 引擎对象，用于加载和管理 QML 文件。 url：指定要加载的 QML 文件的路径。这里加载的是 Entry.qml 文件。 ASCtl_Opts *class_opts = new Class_Opts(); Class_Opts：创建一个 C&#43;&#43; 自定义类的实例，这个对象将暴露给 QML 界面，以便在 QML 中访问和使用。 QObject::connect(button, )：注释掉了的代码行，可能是用于连接某个按钮的信号和槽。 QObject::connect( &amp;engine, &amp;QQmlApplicationEngine::objectCreated, &amp;GUI_app, [url](QObject *obj, const QUrl &amp;objUrl) { if (!obj &amp;&amp; url == objUrl) QCoreApplication::exit(-1); }, Qt::QueuedConnection); QObject::connect：连接信号和槽。这里连接的是 QQmlApplicationEngine 的 objectCreated 信号到一个 lambda 函数。 objectCreated：表示 QML 对象已经创建。 lambda 函数：检查创建的对象是否为空，并且 URL 是否与预期的 URL 匹配。如果对象为空且 URL 匹配，则应用程序退出，返回错误码 -1。 Qt::QueuedConnection：信号和槽的连接类型，表示槽函数将在接收线程的事件循环中执行。 engine.addImportPath(QCoreApplication::applicationDirPath() &#43; &#34;/qml&#34;); engine.addImportPath(&#34;:/&#34;); addImportPath：添加 QML 模块的导入路径。第一个路径是应用程序的工作目录下的 qml 子目录，第二个路径是 Qt 的资源系统路径。 engine.rootContext()-&gt;setContextProperty(&#34;class_Opts&#34;, class_opts); engine.load(url); setContextProperty：将 C&#43;&#43; 对象 (class_opts) 设置为 QML 上下文属性，使 QML 可以访问这个对象。 engine.load(url)：加载指定的 QML 文件并显示其界面。 if (engine.rootObjects().isEmpty()) { return -1; } rootObjects()：获取 QML 引擎中加载的根对象。如果根对象为空，说明 QML 文件加载失败，程序返回 -1 退出。 return glb_GUI_app.exec(); } GUI_app.exec()：启动应用程序的事件循环。这个方法会阻塞，直到应用程序退出。它处理所有的用户输入、定时器事件等。 总结 设置属性：设置 Qt 应用程序的属性来使用软件渲染 OpenGL。 设置环境：调用自定义函数来配置 Qt 环境。 创建应用程序对象：QGuiApplication 处理 GUI 相关任务。 设置图标：检查并设置应用程序窗口图标。 创建 QML 引擎：用于加载和管理 QML 文件。 创建和设置 C&#43;&#43; 对象：将 C&#43;&#43; 对象暴露给 QML。 连接信号和槽：确保 QML 文件正确加载。 设置导入路径：为 QML 引擎添加模块导入路径。 加载 QML 文件：实际加载并显示 QML 界面。 启动事件循环：进入事件循环，处理应用程序事件。 这个 main 函数展示了如何在 Qt 中设置应用程序图标、加载 QML 界面，并将 C&#43;&#43; 对象暴露给 QML，同时确保应用程序在启动时能够正确处理潜在的错误。">
  <meta itemprop="datePublished" content="2024-08-20T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-08-20T00:00:00+00:00">
  <meta itemprop="wordCount" content="343">
  <meta itemprop="keywords" content="Blog,Qt Development,QML">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="QtQuick工程里的main函数解析">
  <meta name="twitter:description" content="当然！这是对 main 函数的详细解读，涵盖了各个部分的功能和目的。
代码逐行解释 int main(int argc, char *argv[]) { QGuiApplication::setAttribute(Qt::AA_UseSoftwareOpenGL); QGuiApplication::setAttribute(Qt::AA_UseSoftwareOpenGL);：设置 Qt 应用程序的属性，强制使用软件渲染 OpenGL。这在没有硬件加速的环境中（例如某些虚拟机或嵌入式系统）非常有用，确保 OpenGL 渲染功能的兼容性。 set_qt_environment(); set_qt_environment()：这似乎是一个自定义函数，用于设置 Qt 环境的其他参数或配置。具体内容取决于你的实际实现。 QGuiApplication GUI_app(argc, argv); QGuiApplication：创建 Qt 的 GUI 应用程序对象，处理与用户界面相关的任务。argc 和 argv 用于传递命令行参数。 // 文件路径 QString iconPath = &#34;://images/icons/app_icon.svg&#34;; iconPath：指定应用程序图标的路径。路径使用 Qt 的资源系统（:// 表示 Qt 资源路径）。 // 检查文件是否存在 if (QFile::exists(iconPath)) { // 文件存在，设置图标 glb_GUI_app.setWindowIcon(QIcon(iconPath)); // qDebug() &lt;&lt; &#34;Icon found and set.&#34;; } else { // 文件不存在，处理错误 qDebug() &lt;&lt; &#34;main(): Icon file not found:&#34; &lt;&lt; iconPath &lt;&lt;&#34;currentDir=&#34;&lt;&lt; QDir::currentPath(); } QFile::exists(iconPath)：检查指定路径的图标文件是否存在。 glb_GUI_app.setWindowIcon(QIcon(iconPath))：如果图标文件存在，则设置应用程序的窗口图标。 qDebug()：用于调试输出，显示图标文件的存在状态和当前工作目录。如果图标文件不存在，会输出相关错误信息。 // ********************** qml ********************************************** QQmlApplicationEngine engine; // const QUrl url(u&#34;qrc:/qt/qml/Main/main.qml&#34;_qs); const QUrl url(u&#34;qrc:/qt/qml/content/Entry.qml&#34;_qs); QQmlApplicationEngine：创建 QML 引擎对象，用于加载和管理 QML 文件。 url：指定要加载的 QML 文件的路径。这里加载的是 Entry.qml 文件。 ASCtl_Opts *class_opts = new Class_Opts(); Class_Opts：创建一个 C&#43;&#43; 自定义类的实例，这个对象将暴露给 QML 界面，以便在 QML 中访问和使用。 QObject::connect(button, )：注释掉了的代码行，可能是用于连接某个按钮的信号和槽。 QObject::connect( &amp;engine, &amp;QQmlApplicationEngine::objectCreated, &amp;GUI_app, [url](QObject *obj, const QUrl &amp;objUrl) { if (!obj &amp;&amp; url == objUrl) QCoreApplication::exit(-1); }, Qt::QueuedConnection); QObject::connect：连接信号和槽。这里连接的是 QQmlApplicationEngine 的 objectCreated 信号到一个 lambda 函数。 objectCreated：表示 QML 对象已经创建。 lambda 函数：检查创建的对象是否为空，并且 URL 是否与预期的 URL 匹配。如果对象为空且 URL 匹配，则应用程序退出，返回错误码 -1。 Qt::QueuedConnection：信号和槽的连接类型，表示槽函数将在接收线程的事件循环中执行。 engine.addImportPath(QCoreApplication::applicationDirPath() &#43; &#34;/qml&#34;); engine.addImportPath(&#34;:/&#34;); addImportPath：添加 QML 模块的导入路径。第一个路径是应用程序的工作目录下的 qml 子目录，第二个路径是 Qt 的资源系统路径。 engine.rootContext()-&gt;setContextProperty(&#34;class_Opts&#34;, class_opts); engine.load(url); setContextProperty：将 C&#43;&#43; 对象 (class_opts) 设置为 QML 上下文属性，使 QML 可以访问这个对象。 engine.load(url)：加载指定的 QML 文件并显示其界面。 if (engine.rootObjects().isEmpty()) { return -1; } rootObjects()：获取 QML 引擎中加载的根对象。如果根对象为空，说明 QML 文件加载失败，程序返回 -1 退出。 return glb_GUI_app.exec(); } GUI_app.exec()：启动应用程序的事件循环。这个方法会阻塞，直到应用程序退出。它处理所有的用户输入、定时器事件等。 总结 设置属性：设置 Qt 应用程序的属性来使用软件渲染 OpenGL。 设置环境：调用自定义函数来配置 Qt 环境。 创建应用程序对象：QGuiApplication 处理 GUI 相关任务。 设置图标：检查并设置应用程序窗口图标。 创建 QML 引擎：用于加载和管理 QML 文件。 创建和设置 C&#43;&#43; 对象：将 C&#43;&#43; 对象暴露给 QML。 连接信号和槽：确保 QML 文件正确加载。 设置导入路径：为 QML 引擎添加模块导入路径。 加载 QML 文件：实际加载并显示 QML 界面。 启动事件循环：进入事件循环，处理应用程序事件。 这个 main 函数展示了如何在 Qt 中设置应用程序图标、加载 QML 界面，并将 C&#43;&#43; 对象暴露给 QML，同时确保应用程序在启动时能够正确处理潜在的错误。">
<link href="/scss/main.css" rel="stylesheet">
<script
  src="https://code.jquery.com/jquery-3.7.1.min.js"
  integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
  crossorigin="anonymous"></script>
<script defer
  src="https://unpkg.com/lunr@2.3.9/lunr.min.js"
  integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli"
  crossorigin="anonymous"></script>
<link rel="stylesheet" href="/css/prism.css"/>

  </head>
  <body class="td-page">
    <header>
      <nav class="td-navbar js-navbar-scroll" data-bs-theme="dark">
<div class="container-fluid flex-column flex-md-row">
  <a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"><svg width="30" height="1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><rect width="100%" height="100%" fill="none"/><text x="50%" y="50%" font-family="Times New Roman" font-weight="bold" font-size="80" text-anchor="middle" fill="#fff" dy=".35em">J</text></svg></span><span class="navbar-brand__name">嵌入式系统爱好者</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="/zh-cn/project/"><span>我的项目</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/zh-cn/news/"><span>News</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link active" href="/zh-cn/blog/"><span>博客文章</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/en/about/"><span>About</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/fa/about/"><span>درباره‌ی ما</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/en/docs/"><span>Docs</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/no/docs/"><span>Dokumentasjon</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/fa/docs/"><span>مستندات</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/en/blog/"><span>Blog</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/fa/blog/"><span>بلاگ</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/en/community/"><span>Community</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/fa/community/"><span>انجمن</span></a>
      </li>
      <li class="nav-item dropdown d-none d-lg-block">
        <div class="dropdown">
  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">简体中文</a>
  <ul class="dropdown-menu">
    <li><a class="dropdown-item" href="/en/">English</a></li>
    </ul>
</div></li>
      <li class="td-light-dark-menu nav-item dropdown">
        <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
  <symbol id="check2" viewBox="0 0 16 16">
    <path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/>
  </symbol>
  <symbol id="circle-half" viewBox="0 0 16 16">
    <path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"/>
  </symbol>
  <symbol id="moon-stars-fill" viewBox="0 0 16 16">
    <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
    <path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/>
  </symbol>
  <symbol id="sun-fill" viewBox="0 0 16 16">
    <path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
  </symbol>
</svg>

<button class="btn btn-link nav-link dropdown-toggle d-flex align-items-center"
        id="bd-theme"
        type="button"
        aria-expanded="false"
        data-bs-toggle="dropdown"
        data-bs-display="static"
        aria-label="Toggle theme (auto)">
  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg>
</button>
<ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
  <li>
    <button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
      <svg class="bi me-2 opacity-50"><use href="#sun-fill"></use></svg>
      Light
      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg>
    </button>
  </li>
  <li>
    <button type="button" class="dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
      <svg class="bi me-2 opacity-50"><use href="#moon-stars-fill"></use></svg>
      Dark
      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg>
    </button>
  </li>
  <li>
    <button type="button" class="dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
      <svg class="bi me-2 opacity-50"><use href="#circle-half"></use></svg>
      Auto
      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg>
    </button>
  </li>
</ul>

      </li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    <div class="td-search td-search--offline">
  <div class="td-search__icon"></div>
  <input
    type="search"
    class="td-search__input form-control"
    placeholder="站内搜索…"
    aria-label="站内搜索…"
    autocomplete="off"
    
    data-offline-search-index-json-src="/offline-search-index.json"
    data-offline-search-base-href="/"
    data-offline-search-max-results="25"
  >
</div>
  </div>
</div>
</nav>
    </header>
    <div class="container-fluid td-default td-outer">
      <main role="main" class="td-main">
        <p>当然！这是对 <code>main</code> 函数的详细解读，涵盖了各个部分的功能和目的。</p>
<h2 id="代码逐行解释"><strong>代码逐行解释</strong></h2>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">int</span> <span style="color:#000">argc</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">char</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">argv</span><span style="color:#000;font-weight:bold">[])</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">QGuiApplication</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">setAttribute</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">Qt</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">AA_UseSoftwareOpenGL</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><ul>
<li><strong><code>QGuiApplication::setAttribute(Qt::AA_UseSoftwareOpenGL);</code></strong>：设置 Qt 应用程序的属性，强制使用软件渲染 OpenGL。这在没有硬件加速的环境中（例如某些虚拟机或嵌入式系统）非常有用，确保 OpenGL 渲染功能的兼容性。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    <span style="color:#000">set_qt_environment</span><span style="color:#000;font-weight:bold">();</span>
</span></span></code></pre></div><ul>
<li><strong><code>set_qt_environment()</code></strong>：这似乎是一个自定义函数，用于设置 Qt 环境的其他参数或配置。具体内容取决于你的实际实现。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    <span style="color:#000">QGuiApplication</span> <span style="color:#000">GUI_app</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">argc</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">argv</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><ul>
<li><strong><code>QGuiApplication</code></strong>：创建 Qt 的 GUI 应用程序对象，处理与用户界面相关的任务。<code>argc</code> 和 <code>argv</code> 用于传递命令行参数。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// 文件路径
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">QString</span> <span style="color:#000">iconPath</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#34;://images/icons/app_icon.svg&#34;</span><span style="color:#000;font-weight:bold">;</span>
</span></span></code></pre></div><ul>
<li><strong><code>iconPath</code></strong>：指定应用程序图标的路径。路径使用 Qt 的资源系统（<code>://</code> 表示 Qt 资源路径）。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// 检查文件是否存在
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">QFile</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">exists</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">iconPath</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// 文件存在，设置图标
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000">glb_GUI_app</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">setWindowIcon</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">QIcon</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">iconPath</span><span style="color:#000;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// qDebug() &lt;&lt; &#34;Icon found and set.&#34;;
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// 文件不存在，处理错误
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000">qDebug</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#4e9a06">&#34;main(): Icon file not found:&#34;</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">iconPath</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span><span style="color:#4e9a06">&#34;currentDir=&#34;</span><span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#000">QDir</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">currentPath</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><ul>
<li><strong><code>QFile::exists(iconPath)</code></strong>：检查指定路径的图标文件是否存在。</li>
<li><strong><code>glb_GUI_app.setWindowIcon(QIcon(iconPath))</code></strong>：如果图标文件存在，则设置应用程序的窗口图标。</li>
<li><strong><code>qDebug()</code></strong>：用于调试输出，显示图标文件的存在状态和当前工作目录。如果图标文件不存在，会输出相关错误信息。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// ********************** qml **********************************************
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">QQmlApplicationEngine</span> <span style="color:#000">engine</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// const QUrl url(u&#34;qrc:/qt/qml/Main/main.qml&#34;_qs);
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">QUrl</span> <span style="color:#000">url</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">u</span><span style="color:#4e9a06">&#34;qrc:/qt/qml/content/Entry.qml&#34;</span><span style="color:#000">_qs</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><ul>
<li><strong><code>QQmlApplicationEngine</code></strong>：创建 QML 引擎对象，用于加载和管理 QML 文件。</li>
<li><strong><code>url</code></strong>：指定要加载的 QML 文件的路径。这里加载的是 <code>Entry.qml</code> 文件。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    <span style="color:#000">ASCtl_Opts</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">class_opts</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">Class_Opts</span><span style="color:#000;font-weight:bold">();</span>    
</span></span></code></pre></div><ul>
<li><strong><code>Class_Opts</code></strong>：创建一个 C++ 自定义类的实例，这个对象将暴露给 QML 界面，以便在 QML 中访问和使用。</li>
<li><strong><code>QObject::connect(button, )</code></strong>：注释掉了的代码行，可能是用于连接某个按钮的信号和槽。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    <span style="color:#000">QObject</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">connect</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">engine</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">QQmlApplicationEngine</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">objectCreated</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">GUI_app</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">[</span><span style="color:#000">url</span><span style="color:#000;font-weight:bold">](</span><span style="color:#000">QObject</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">obj</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">QUrl</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">objUrl</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">obj</span> <span style="color:#ce5c00;font-weight:bold">&amp;&amp;</span> <span style="color:#000">url</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">objUrl</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000">QCoreApplication</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">exit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">Qt</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">QueuedConnection</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><ul>
<li><strong><code>QObject::connect</code></strong>：连接信号和槽。这里连接的是 <code>QQmlApplicationEngine</code> 的 <code>objectCreated</code> 信号到一个 lambda 函数。</li>
<li><strong><code>objectCreated</code></strong>：表示 QML 对象已经创建。</li>
<li><strong>lambda 函数</strong>：检查创建的对象是否为空，并且 URL 是否与预期的 URL 匹配。如果对象为空且 URL 匹配，则应用程序退出，返回错误码 <code>-1</code>。</li>
<li><strong><code>Qt::QueuedConnection</code></strong>：信号和槽的连接类型，表示槽函数将在接收线程的事件循环中执行。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    <span style="color:#000">engine</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">addImportPath</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">QCoreApplication</span><span style="color:#ce5c00;font-weight:bold">::</span><span style="color:#000">applicationDirPath</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;/qml&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">engine</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">addImportPath</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;:/&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><ul>
<li><strong><code>addImportPath</code></strong>：添加 QML 模块的导入路径。第一个路径是应用程序的工作目录下的 <code>qml</code> 子目录，第二个路径是 Qt 的资源系统路径。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    <span style="color:#000">engine</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">rootContext</span><span style="color:#000;font-weight:bold">()</span><span style="color:#ce5c00;font-weight:bold">-&gt;</span><span style="color:#000">setContextProperty</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;class_Opts&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">class_opts</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">engine</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">load</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">url</span><span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><ul>
<li><strong><code>setContextProperty</code></strong>：将 C++ 对象 (<code>class_opts</code>) 设置为 QML 上下文属性，使 QML 可以访问这个对象。</li>
<li><strong><code>engine.load(url)</code></strong>：加载指定的 QML 文件并显示其界面。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">engine</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">rootObjects</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">isEmpty</span><span style="color:#000;font-weight:bold">())</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><ul>
<li><strong><code>rootObjects()</code></strong>：获取 QML 引擎中加载的根对象。如果根对象为空，说明 QML 文件加载失败，程序返回 <code>-1</code> 退出。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">glb_GUI_app</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">exec</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><ul>
<li><strong><code>GUI_app.exec()</code></strong>：启动应用程序的事件循环。这个方法会阻塞，直到应用程序退出。它处理所有的用户输入、定时器事件等。</li>
</ul>
<h3 id="总结">总结</h3>
<ol>
<li><strong>设置属性</strong>：设置 Qt 应用程序的属性来使用软件渲染 OpenGL。</li>
<li><strong>设置环境</strong>：调用自定义函数来配置 Qt 环境。</li>
<li><strong>创建应用程序对象</strong>：<code>QGuiApplication</code> 处理 GUI 相关任务。</li>
<li><strong>设置图标</strong>：检查并设置应用程序窗口图标。</li>
<li><strong>创建 QML 引擎</strong>：用于加载和管理 QML 文件。</li>
<li><strong>创建和设置 C++ 对象</strong>：将 C++ 对象暴露给 QML。</li>
<li><strong>连接信号和槽</strong>：确保 QML 文件正确加载。</li>
<li><strong>设置导入路径</strong>：为 QML 引擎添加模块导入路径。</li>
<li><strong>加载 QML 文件</strong>：实际加载并显示 QML 界面。</li>
<li><strong>启动事件循环</strong>：进入事件循环，处理应用程序事件。</li>
</ol>
<p>这个 <code>main</code> 函数展示了如何在 Qt 中设置应用程序图标、加载 QML 界面，并将 C++ 对象暴露给 QML，同时确保应用程序在启动时能够正确处理潜在的错误。</p>
<h2 id="暴露整个类对象给qml的意义何在"><strong>暴露整个类对象给QML的意义何在？</strong></h2>
<p>暴露整个 C++ 类的对象给 QML 主要有以下几个目的和考虑，但这些目的在不同的场景下可能有不同的实现方式，因此也需要根据实际需求来选择是否采用 <code>Q_PROPERTY</code> 或其他方式。</p>
<h3 id="1-访问复杂逻辑或功能">1. <strong>访问复杂逻辑或功能</strong>：</h3>
<ul>
<li>如果你有一个复杂的 C++ 类，这个类封装了一些业务逻辑、算法或功能（例如网络请求、数据处理、硬件交互等），你可以通过暴露整个对象给 QML，让 QML 层能够调用这个对象的方法。这些方法可能不只是简单的数据访问，还包括一些逻辑操作，比如计算、状态管理等。</li>
<li>在这种情况下，QML 通过调用 C++ 对象的方法，可以利用 C++ 的强大功能，弥补 QML 本身的能力不足。例如，执行某些复杂的操作，然后将结果返回给 QML。</li>
</ul>
<h3 id="2-共享和管理状态">2. <strong>共享和管理状态</strong>：</h3>
<ul>
<li>如果你的 C++ 类管理了一些全局或共享状态（例如应用程序的配置、运行状态、数据缓存等），暴露这个对象给 QML 可以让 QML 访问和操作这些状态。在这种情况下，暴露整个对象可以简化在多个 QML 组件之间共享数据或状态的需求。</li>
</ul>
<h3 id="3-整合-c-和-qml-的开发">3. <strong>整合 C++ 和 QML 的开发</strong>：</h3>
<ul>
<li>在某些项目中，可能需要将 C++ 层的功能和 QML 层的 UI 进行紧密整合。暴露整个 C++ 类的对象可以减少接口设计的复杂性，使得 QML 可以直接利用 C++ 层的现有代码，不需要重复定义接口或桥接代码。</li>
</ul>
<h3 id="4-使用单例模式的好处">4. <strong>使用单例模式的好处</strong>：</h3>
<ul>
<li>如果你使用单例模式暴露 C++ 对象，那么这个对象在整个应用程序中只有一个实例。这在某些情况下很有用，比如你希望确保某些数据或状态在应用程序的所有部分中保持一致。这种方式常用于全局管理器类（如设置管理器、数据库连接管理器等），这些类的实例通常只有一个，且在应用程序的整个生命周期内都存在。</li>
</ul>
<h3 id="5-q">5. <strong>Q_PROPERTY 的作用</strong>：</h3>
<ul>
<li>如果你仅仅暴露整个 C++ 对象而不使用 <code>Q_PROPERTY</code>，那么 QML 层可能无法直接访问对象的属性，尤其是私有或受保护的成员变量。<code>Q_PROPERTY</code> 的作用在于允许 QML 层将某些 C++ 属性作为 QML 属性来使用，使得这些属性可以直接在 QML 中绑定、显示，并在值变化时自动触发更新。</li>
<li>另一方面，如果你不使用 <code>Q_PROPERTY</code>，但仍然希望 QML 能访问到某些公有数据，你可能需要手动定义 getter 和 setter 方法，然后在 QML 中通过调用这些方法来获取或设置数据。然而，这种方式无法实现自动数据同步，且代码更为冗长。</li>
</ul>
<h3 id="总结-1">总结：</h3>
<p>暴露整个 C++ 对象给 QML 的意义在于允许 QML 层访问和调用这个对象所提供的功能和方法，而不仅仅是访问简单的数据。如果只是为了访问某个数据属性，<code>Q_PROPERTY</code> 是更好的选择，它不仅可以简化代码，还能实现数据的自动同步更新。</p>
<p>如果你发现暴露整个类对象对于你的需求并不合适或不方便，那么你可以选择只暴露必要的功能和属性（例如通过 <code>Q_PROPERTY</code>），这样可以确保代码的清晰性和维护性。选择合适的方式取决于你的具体应用场景和需求。</p>

      </main>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="td-footer__left col-6 col-sm-4 order-sm-1">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="X" aria-label="X">
    <a target="_blank" rel="noopener" href="https://x.com/potter_whi3340" aria-label="X">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Stack Overflow" aria-label="Stack Overflow">
    <a target="_blank" rel="noopener" href="https://example.org/stack" aria-label="Stack Overflow">
      <i class="fab fa-stack-overflow"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__right col-6 col-sm-4 order-sm-3">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="GitHub" aria-label="GitHub">
    <a target="_blank" rel="noopener" href="https://github.com/potterwhite" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Slack" aria-label="Slack">
    <a target="_blank" rel="noopener" href="https://example.org/slack" aria-label="Slack">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2">
        <span class="td-footer__copyright">&copy;
    2024&ndash;2025
    <span class="td-footer__authors">Potter White | <a href="https://creativecommons.org/licenses/by/4.0">CC BY 4.0</a> |</span></span><span class="td-footer__all_rights_reserved">保留所有权利</span><span class="ms-2"><a href="https://policies.google.com/privacy" target="_blank" rel="noopener">隐私政策</a></span>
      </div>
    </div>
  </div>
</footer>

    </div>
    <script src="/js/main.js"></script>
<script src='/js/prism.js'></script>
<script src='/js/tabpane-persist.js'></script>

  </body>
</html>